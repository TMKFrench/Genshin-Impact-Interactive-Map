$(window).load((function(){var mymap,markeropa,catmarkers=[],savearray=[],cordiarray=[],cdelicarray=[],cprecarray=[],cluxearray=[],cdefiarray=[],cfeearray=[],succesarray=[],anemoarray=[],panoarray=[],liyuearray=["cordil","cdelicl","cprecl","cluxel","cdefil","cfeel","succesl","geocul","panol"],nbtmark=0;function onMapClick(e){console.log(i18n["ui-click"]+mymap.wrapLatLng(e.latlng))}function onMarkerClick(e){markeropa=this}function markeropacity(e){e?markeropa.setOpacity(.45):markeropa.setOpacity(1)}function initarray(){for(var i=0;catmarkers[i];){switch(cookname="chkbox"+catmarkers[i],catmarkers[i]){case"cordi":cordiarray=JSON.parse(localStorage.getItem(cookname));break;case"cdelic":cdelicarray=JSON.parse(localStorage.getItem(cookname));break;case"cprec":cprecarray=JSON.parse(localStorage.getItem(cookname));break;case"cluxe":cluxearray=JSON.parse(localStorage.getItem(cookname));break;case"cdefi":cdefiarray=JSON.parse(localStorage.getItem(cookname));break;case"cfee":cfeearray=JSON.parse(localStorage.getItem(cookname));break;case"succes":succesarray=JSON.parse(localStorage.getItem(cookname));break;case"anemo":anemoarray=JSON.parse(localStorage.getItem(cookname));break;case"pano":panoarray=JSON.parse(localStorage.getItem(cookname))}i++}}function initmarker(markers,cbxname){$.cookie.json=!0,$.cookie("chkbox"+cbxname)&&(localStorage.setItem("chkbox"+cbxname,JSON.stringify($.cookie("chkbox"+cbxname))),$.removeCookie("chkbox"+cbxname,{path:"/"}));var cookm=JSON.parse(localStorage.getItem("chkbox"+cbxname)),i=0;if(catmarkers.push(cbxname),cookm)for(;cookm[i];)markeropa=markers[cookm[i]-1],markeropacity(!0),i++}function initmarkerdebug(markers,cbxname){var cookm=JSON.parse(localStorage.getItem("chkbox"+cbxname));console.log(localStorage.getItem("chkbox"+cbxname));var i=0;if(catmarkers.push(cbxname),cookm)for(;cookm[i];)markeropa=markers[cookm[i]-1],console.log("Marker n° "+cookm[i]),markeropacity(!0),i++}function selectarray(mtype,mnumb,mstate){switch(mtype){case"cordi":cookts=gestionarray(cordiarray,mnumb,mstate);break;case"cdelic":cookts=gestionarray(cdelicarray,mnumb,mstate);break;case"cprec":cookts=gestionarray(cprecarray,mnumb,mstate);break;case"cluxe":cookts=gestionarray(cluxearray,mnumb,mstate);break;case"cdefi":cookts=gestionarray(cdefiarray,mnumb,mstate);break;case"cfee":cookts=gestionarray(cfeearray,mnumb,mstate);break;case"succes":cookts=gestionarray(succesarray,mnumb,mstate);break;case"anemo":cookts=gestionarray(anemoarray,mnumb,mstate);break;case"pano":cookts=gestionarray(panoarray,mnumb,mstate)}localStorage.setItem("chkbox"+mtype,JSON.stringify(cookts))}function gestionarray(tempcook,chknb,etat){if(etat)tempcook.push(chknb);else for(var i=0;tempcook[i];)tempcook[i]==chknb&&tempcook.splice(i,1),i++;return tempcook}function activecb(mtype,mnumb){var arrayvide=[];if(cooktl=JSON.parse(localStorage.getItem("chkbox"+mtype)),cooktl){for(var i=0;cooktl[i];){if(cooktl[i]==mnumb)return!0;i++}return!1}return localStorage.setItem("chkbox"+mtype,JSON.stringify(arrayvide)),initarray(),!1}function resetmarkers(){doreset(),alert(i18n["ui-reset"]),"fr"==sessionStorage.languagemap?document.location.href="indexfr.html":document.location.href="index.html"}function doreset(){var i=0,cbx,arraytoreset=catmarkers.concat(liyuearray);for(console.log(JSON.stringify(arraytoreset));arraytoreset[i];)cbx="chkbox"+arraytoreset[i],localStorage.removeItem(cbx),i++}function savecookies(){savearray=["v2","cordi",cordiarray,"cdelic",cdelicarray,"cprec",cprecarray,"cluxe",cluxearray,"cdefi",cdefiarray,"cfee",cfeearray,"succes",succesarray,"anemo",anemoarray,"pano",panoarray];for(var i=0,cbx;liyuearray[i];)cbx="chkbox"+liyuearray[i],savearray.push(liyuearray[i]),localStorage.getItem(cbx)?savearray.push(JSON.parse(localStorage.getItem(cbx))):savearray.push([]),i++;return savearray}function loadcookies(lstmrk){if("v2"==lstmrk[0]){doreset();for(var i=1,cbx;lstmrk[i];)cbx="chkbox"+lstmrk[i],localStorage.setItem(cbx,JSON.stringify(lstmrk[i+1])),i+=2;alert(i18n["ui-import"]),"fr"==sessionStorage.languagemap?document.location.href="indexfr.html":document.location.href="index.html"}else alert(i18n["ui-fileerror"])}function reselectmenu(){if($("#activation-select-options li").each((function(){$(this).hasClass("selected")&&$("."+$(this).attr("value")).hide()})),$(".matbtn").each((function(){$(this).hasClass("pressed")&&$("."+$(this).attr("value")).hide()})),localStorage.MenumapgenshinMLi)var listatut=JSON.parse(localStorage.MenumapgenshinMLi);else localStorage.MenumapgenshinMLi=[];if(localStorage.MenumapgenshinMBtn)var btnstatut=JSON.parse(localStorage.MenumapgenshinMBtn);else localStorage.MenumapgenshinMBtn=[];listatut&&listatut.forEach((function(element){$("#li"+element).removeClass("selected"),$("."+element).show()})),btnstatut&&btnstatut.forEach((function(element){$("#btn"+element).removeClass("pressed").attr("src","/media/icones/"+element+"on.png"),$("."+element).show()}))}function openMenu(){$("#activation-select-box").addClass("selecting").text(i18n["ui-close"]),$("#activation-select-options").slideDown(150)}lightbox.option({fadeDuration:400,imageFadeDuration:400,maxWidth:1200,maxHeight:900,resizeDuration:400}),$((function(){(mymap=L.map("mapid",{crs:L.CRS.Simple,minZoom:-2,maxZoom:2})).setMaxBounds(new L.latLngBounds([-700,-200],[3025,4086])),mymap.zoomControl.setPosition("topright");var bounds=[[0,0],[2325,3886]],image=L.imageOverlay("/media/map-mondstadt.jpg",bounds).addTo(mymap),markerspano,markerscordi,markerscdelic,markerscprec,markerscluxe,markerscdefi,markerscfee,markersanemo;function loadmarker(marklist,markico,marktitle,filename,cbxname){var listback=[],marq=[],nfichier,i,mtype;for(i=0;i<marklist.length;i++)switch(nfichier=filename+(i+1),mtype=(marq=marklist[i])[0]){case 0:L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).bindPopup(`<a href="/media/${nfichier}.jpg" data-lightbox="${nfichier}" data-title="${marktitle}"><img class="thumb" src="/media/${nfichier}.jpg"/></a>`,popupOptions);break;case 1:listback.push(L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).on("click",onMarkerClick).bindPopup(`<a href="/media/${nfichier}.jpg" data-lightbox="${nfichier}" data-title="${marktitle}"><img class="thumb" src="/media/${nfichier}.jpg"/></a><br><h2><input id="mapbox" name="${cbxname}" value="${i+1}" type="checkbox" /> Trouvé</h2>`,popupOptions));break;case 2:L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).bindPopup(`<h1><a href="/media/${nfichier}.jpg" data-lightbox="${nfichier}" data-title="${marktitle}"><img class="thumb" src="/media/${nfichier}.jpg"/></a><br><br>${marq[2]}</h1>`,popupOptions);break;case 3:listback.push(L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).on("click",onMarkerClick).bindPopup(`<h1><a href="/media/${nfichier}.jpg" data-lightbox="${nfichier}" data-title="${marktitle}"><img class="thumb" src="/media/${nfichier}.jpg"/></a><br><br>${marq[2]}<br><h2><input id="mapbox" name="${cbxname}" value="${i+1}" type="checkbox" /> Trouvé</h2>`,popupOptions));break;case 4:L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).bindPopup(`<iframe width="560" height="315" src="//www.youtube.com/embed/${marq[2]}?rel=0" frameborder="0" allowfullscreen></iframe>`,popupOptions);break;case 5:listback.push(L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).on("click",onMarkerClick).bindPopup(`<iframe width="560" height="315" src="//www.youtube.com/embed/${marq[2]}?rel=0" frameborder="0" allowfullscreen></iframe><br><h2><input id="mapbox" name="${cbxname}" value="${i+1}" type="checkbox" /> Trouvé</h2>`,popupOptions));break;case 6:L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).bindPopup(`<iframe width="560" height="315" src="//www.youtube.com/embed/${marq[2]}?rel=0" frameborder="0" allowfullscreen></iframe><br><h1>${marq[3]}</h1>`,popupOptions);break;case 7:listback.push(L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).on("click",onMarkerClick).bindPopup(`<iframe width="560" height="315" src="//www.youtube.com/embed/${marq[2]}?rel=0" frameborder="0" allowfullscreen></iframe><br><h1>${marq[3]}<br><h2><input id="mapbox" name="${cbxname}" value="${i+1}" type="checkbox" /> Trouvé</h2></h1>`,popupOptions));break;case 8:L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).bindPopup(`<h1>${marq[2]}</h1>`,popupOptions);break;case 9:listback.push(L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap).on("click",onMarkerClick).bindPopup(`<h1>${marq[2]}<br><h2><input id="mapbox" name="${cbxname}" value="${i+1}" type="checkbox" /> Trouvé</h2></h1>`,popupOptions));break;case 10:L.marker(marq[1],{icon:Null,title:""}).addTo(mymap).bindPopup(`<h1>${marq[2]}</h1>`,popupOptions);break;case 11:listback.push(L.marker(marq[1],{icon:Null,title:""}).addTo(mymap).on("click",onMarkerClick).bindPopup(`<h1>${marq[2]}<br><h2><input id="mapbox" name="${cbxname}" value="${i+1}" type="checkbox" /> Trouvé</h2></h1>`,popupOptions));break;case 12:L.marker(marq[1],{icon:markico,title:marktitle}).addTo(mymap)}return console.log(marktitle+" : "+marklist.length+i18n["ui-load"]),nbtmark+=marklist.length,listback}mymap.fitBounds(bounds),loadmarker(liststatue,Statue,i18n.cat01,"statue",""),loadmarker(listteleport,Teleport,i18n.cat02,"tp",""),initmarker(loadmarker(listpano,Pano,i18n.cat03,"pano","pano"),"pano"),initmarker(loadmarker(listcordi,Cordi,i18n.cat04,"oc","cordi"),"cordi"),initmarker(loadmarker(listcdelic,Cdelic,i18n.cat05,"dc","cdelic"),"cdelic"),initmarker(loadmarker(listcprec,Cprec,i18n.cat06,"pc","cprec"),"cprec"),initmarker(loadmarker(listcluxe,Cluxe,i18n.cat07,"lc","cluxe"),"cluxe"),initmarker(loadmarker(listcdefi,Cdefi,i18n.cat08,"defi","cdefi"),"cdefi"),initmarker(loadmarker(listcfee,Cfee,i18n.cat09,"","cfee"),"cfee"),initmarker(loadmarker(listanemo,Anemo,i18n.cat10,"anemo","anemo"),"anemo"),loadmarker(listcristal,Cristal,i18n.cat11,"",""),loadmarker(listelectroc,Electrocris,i18n.cat12,"",""),loadmarker(listfbrume,Fbrume,i18n.cat13,"",""),loadmarker(listffeu,Ffeu,i18n.cat14,"",""),loadmarker(listpomme,Pomme,i18n.cat15,"",""),loadmarker(listcarotte,Carotte,i18n.cat16,"",""),loadmarker(listradis,Radis,i18n.cat17,"",""),loadmarker(listtombaie,Tombaie,i18n.cat18,"",""),loadmarker(listpissenlit,Pissenlit,i18n.cat19,"",""),loadmarker(listhalampe,Halampe,i18n.cat20,"",""),loadmarker(listchrysantheme,Chrysantheme,i18n.cat21,"",""),loadmarker(listlyscalla,Lyscalla,i18n.cat22,"",""),loadmarker(listcecilia,Cecilia,i18n.cat23,"",""),loadmarker(listbacrochet,Bacrochet,i18n.cat24,"",""),loadmarker(listferblanc,Ferblanc,i18n.cat25,"",""),loadmarker(listeclatcm,Eclatcm,i18n.cat26,"",""),loadmarker(listgrenouille,Grenouille,i18n.cat27,"",""),loadmarker(listlezard,Lezard,i18n.cat28,"",""),loadmarker(listpapillon,Papillon,i18n.cat42,"",""),loadmarker(listluciole,Luciole,i18n.cat43,"",""),loadmarker(listnoyauc,Noyauc,i18n.cat44,"","");var markerssucces=[L.marker([1378,1754],{icon:Succes,title:i18n["succes-001-title"]}).addTo(mymap).on("click",onMarkerClick).bindPopup('<iframe width="560" height="315" src="//www.youtube.com/embed/gi8SNBMgcJQ?rel=0" frameborder="0" allowfullscreen></iframe><h1>'+i18n["succes-001-h1"]+'</h1><h2><label><input id="mapbox" name="succes" value="1" type="checkbox" /> '+i18n["ui-found"]+"</label></h2>",popupOptions),L.marker([1831,2791],{icon:Succes,title:i18n["succes-002-title"]}).addTo(mymap).on("click",onMarkerClick).bindPopup('<iframe width="560" height="315" src="//www.youtube.com/embed/zWyh1IzC9p4?rel=0" frameborder="0" allowfullscreen></iframe><h1>'+i18n["succes-002-h1"]+'</h1><h2><label><input id="mapbox" name="succes" value="2" type="checkbox" /> '+i18n["ui-found"]+"</label></h2>",popupOptions),L.marker([422,2579],{icon:Succes,title:i18n["succes-003-title"]}).addTo(mymap).on("click",onMarkerClick).bindPopup('<iframe width="560" height="315" src="//www.youtube.com/embed/3c27WzF91L4?rel=0" frameborder="0" allowfullscreen></iframe><h1>'+i18n["succes-003-h1"]+'</h1><h2><label><input id="mapbox" name="succes" value="3" type="checkbox" /> '+i18n["ui-found"]+"</label></h2>",popupOptions),L.marker([604,3080],{icon:Succes,title:i18n["succes-004-title"]}).addTo(mymap).on("click",onMarkerClick).bindPopup('<iframe width="560" height="315" src="//www.youtube.com/embed/bLlx2q5xJ_k?rel=0" frameborder="0" allowfullscreen></iframe><h1>'+i18n["succes-002-h1"]+'</h1><h2><label><input id="mapbox" name="succes" value="4" type="checkbox" /> '+i18n["ui-found"]+"</label></h2>",popupOptions),L.marker([1314,1260],{icon:Succes,title:i18n["succes-005-title"]}).addTo(mymap).on("click",onMarkerClick).bindPopup('<iframe width="560" height="315" src="//www.youtube.com/embed/fzLJspb266A?rel=0" frameborder="0" allowfullscreen></iframe><h1>'+i18n["succes-005-h1"]+'</h1><h2><label><input id="mapbox" name="succes" value="5" type="checkbox" /> '+i18n["ui-found"]+"</label></h2>",popupOptions),L.marker([1711,871],{icon:Succes,title:i18n["succes-006-title"]}).addTo(mymap).on("click",onMarkerClick).bindPopup('<iframe width="560" height="315" src="//www.youtube.com/embed/pBKixxEk71c?rel=0" frameborder="0" allowfullscreen></iframe><h1>'+i18n["succes-006-h1"]+'</h1><h2><label><input id="mapbox" name="succes" value="6" type="checkbox" /> '+i18n["ui-found"]+"</label></h2>",popupOptions)];initmarker(markerssucces,"succes"),nbtmark+=markerssucces.length,console.log(i18n["ui-succes"]+markerssucces.length+i18n["ui-load"]),localStorage.nbtliyue?nbtmark+=Number(localStorage.nbtliyue):localStorage.nbtliyue=0,L.marker([100,150],{icon:Alire,title:"Notes Importantes"}).addTo(mymap).bindPopup('<h4>Notes Importantes</h4><br><h3>Utilisation du Stockage Local :</h3><p style="color : red;">Ce site utilise un système de Stockage Local pour sauvegarder<br>vos préférences et avancement sur la Map (Menu et marqueurs).<br>En aucun cas nous ne recupérons et stockons de données personnelles.<br>Les fonctions de Reset et d\'Import/export agissent sur<br>les 2 maps de Mondstadt ET Liyue !!!</p>',popupOptions),"fr"==sessionStorage.languagemap?L.marker([60,1943],{icon:Null,title:""}).addTo(mymap).bindPopup('<h4><img src="/media/logo.jpg"/><br>TMKFrench - LGDC</h4><h3>NOUVEAU !!! Tous les Panoramas<br>Bienvenue sur notre Map interactive !</h3><p>Cliquez sur une icône de votre choix pour plus d\'info.<br>Utilisez la molette de la souris pour zoomer<br>et le menu pour afficher ou masquer les POIs.<br><a style="color:red;">Nombre de Marker : '+nbtmark+"</a><br><br><a style=\"color : red;\"><strong>Release V3.5 du 11/11/2020</strong></a><br>Rajout des marqueurs pour les matériaux de farm<br>Passage au Stockage local à la place des cookies<br>Mise en ligne de la map de Liyue.<br><br>Si vous voulez participer en m'envoyant de nouveaux<br>emplacements, n'hésitez pas à me contacter<br>par mail à infomap@tmkfrench.fr ou par<br>MP sur discord : TMKFrench#4221",{minWidth:"640px",minHeight:"480px"}).openPopup():L.marker([60,1943],{icon:Null,title:""}).addTo(mymap).bindPopup('<h4><img src="media/logo.jpg"/><br>TMKFrench - LGDC</h4><h3>NEW !!! All Viewpoint<br>Welcome to our Interactive Map !</h3><p>Clic on a Marker of your choice for more information.<br>Use mouse wheel to zoom<br>and the menu to toggle POIs.<br><a style="color:red;">Marker\'s count : '+nbtmark+'</a><br><br><a style="color : red;"><strong>Release V3.5 of 11/11/2020</strong></a><br>Adding Materials markers. Using local storage instead of cookies.<br>Liyue\'s Map is Online<br><br>If you want to participate, giving me new location on<br>map, feel free to contact me by mail<br>at infomap@tmkfrench.fr or by Discord PM : TMKFrench#4221',{minWidth:"640px",minHeight:"480px"}).openPopup(),mymap.on("click",onMapClick),mymap.on("popupopen",(function(){if($(":checkbox").on("change",(function(){var checkboxtype=this.name,checkboxnumber=this.value,checkboxstate=this.checked;selectarray(checkboxtype,checkboxnumber,checkboxstate),markeropacity(checkboxstate)})),document.getElementById("mapbox")){var checkboxtype,checkboxnumber,checkboxstate=activecb(document.getElementById("mapbox").name,document.getElementById("mapbox").value);$("#mapbox").prop("checked",checkboxstate)}})),$("#activation-select-box").on("click",(function(){$(this).hasClass("selecting")?($(this).removeClass("selecting").text(i18n["ui-open"]),$("#activation-select-options").slideUp(150)):($(this).addClass("selecting").text(i18n["ui-close"]),$("#activation-select-options").slideDown(150))})),$("#activation-select-options li").on("click",(function(){var val=$(this).attr("value");$(this).toggleClass("selected"),$("."+val).toggle();var listatut=[];$("#activation-select-options li").each((function(){$(this).hasClass("section")||$(this).hasClass("selected")||$(this).hasClass("selectbtn")||listatut.push($(this).attr("value"))})),localStorage.MenumapgenshinMLi=JSON.stringify(listatut)})),$(".matbtn").on("click",(function(){var ndf=$(this).attr("value");$(this).hasClass("pressed")?($(this).attr("src","/media/icones/"+ndf+"on.png"),$(this).toggleClass("pressed")):($(this).attr("src","/media/icones/"+ndf+"off.png"),$(this).toggleClass("pressed")),$("."+ndf).toggle();var btnstatut=[];$(".matbtn").each((function(){$(this).hasClass("pressed")||btnstatut.push($(this).attr("value"))})),localStorage.MenumapgenshinMBtn=JSON.stringify(btnstatut)})),$("#BtnReset").on("click",(function(){confirm(i18n["ui-prereset"])&&resetmarkers()})),$("#BtnEnglish").on("click",(function(){localStorage.asken=1,document.location.href="index.html"})),$("#BtnFrench").on("click",(function(){document.location.href="indexfr.html"})),$("#BtnExport").on("click",(function(){this.href=URL.createObjectURL(new Blob([JSON.stringify(savecookies())])),alert(i18n["ui-export"])})),$("#BtnImport").on("click",(function(e){var fileElem=document.getElementById("ImportBox");fileElem&&fileElem.click(),e.preventDefault()})),$("#ImportBox").on("change",(function(ev_){var fr_;(fr_=new FileReader).onload=function(ev_){loadcookies(JSON.parse(this.result))},fr_.readAsText(this.files[0])})),$("#btnmap").on("click",(function(){"fr"==sessionStorage.languagemap?document.location.href="indexl.html":document.location.href="indexlen.html"}))})),initarray(),reselectmenu(),openMenu()}));